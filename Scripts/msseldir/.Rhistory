add.points(male.mean,"blue")
resfile<-male.mean
tmp<-resfile[resfile$BP>=(pos-size.reg) & resfile$BP<=(pos+size.reg) & resfile$CHR==chr,]
min(tmp$P)
log10(min(tmp$P))
mean(female.mean$P<.05)
mean(female.mean$P<.01)
ls()
AGRE.hot.ad[AGRE.hot.ad$SNP=="rs13040127",]
AGRE.hot.ad[AGRE.hot.ad$SNP=="rs6097632",]
par(oma=c(0,0,0,0))par(mar=c(3.5,4.2,1.5,0.1))a_d=10h=0.5G=1000/(20000)layout(1:2)par(cex.axis = 1, cex.lab = 1,cex.main=1)plot(range(seq(1/10000,.1,length=100000)),c(0,1),type="n",log="x",ylim=c(0,1),ylab="Prob. of fixing standing var.",xlab="");mtext(line=2,side=1,"Selective advantage")mtext("A. Probability of a sweep from standing variation.",at=.8e-4,adj=0,cex=1)for(L in c(1,100,1000)){theta=2E-8*10000*L*4s=c(seq(1/10000,1/1000,length=100),seq(1/1000,.1,length=100))a_b=2*10000*s R=2*h*a_b/(2*h*a_d+1) pr_st = (1-exp(-theta*log(1+R)))lines(s,pr_st,type="l",lwd=3); text(paste("L = ",L,"bp",sep=""),x=.05,y=pr_st[min(which(s>0.05))],col="red",cex=1.5)}#text(1e-4,.98,"A",cex=1.5)plot(range(seq(1/10000,.1,length=100000)),c(0,1),type="n",log="x",ylim=c(0,1),ylab="Prob. of standing var. adaptation",xlab="");mtext(line=2,side=1,"Selective advantage")mtext("B. Probability that a sweep is from standing variation, conditional on a sweep.",at=.8e-4,adj=0,cex=1)for(L in c(1,100,1000)){theta=
2E-8*10000*L*4s=c(seq(1/10000,1/1000,length=100),seq(1/1000,.1,length=100))a_b=2*10000*s R=2*h*a_b/(2*h*a_d+1) pr_st = (1-exp(-theta*log(1+R)))/(1-exp(-theta*(log(1+R)+h*a_b*G)))lines(s,pr_st,type="l",lwd=3); text(paste("L = ",L,"bp",sep=""),x=.05,y=pr_st[min(which(s>0.05))],col="red",cex=1.5)}#text(1e-4,.98,"B",cex=1.5)
25000000 * (168/767)
25,000,000 x (359/767)
25000000 * (359/767)
11701434/2
(76+14+70+199)
2*2*2
800/8
23212
2*3*2*12
2*3*2*12*50
2*3*2*12*50/2
50 * 2 * 2 * 2 * 2
7000/8
1000/10
1000/20
900/20
1000/20
2/6
60*1/3
-s*p*q*(h*(1-2*(1-p))+s*(1-p)]
-s*p*q*(h*(1-2*(1-p))+s*(1-p))
s=.1
p=.4
h=1/2
-s*p*q*(h*(1-2*(1-p))+s*(1-p))
-s*p*(1-p)*(h*(1-2*(1-p))+s*(1-p))
36e6/3e9
midterm1<-read.table("~/Dropbox/Courses/EVE100_2011/Grades/Exam1Grades.csv",as.is=T,sep="\t")
midterm1[1,]
midterm1<-read.table("~/Dropbox/Courses/EVE100_2011/Grades/Exam1Grades.csv",as.is=T,head=T)
midterm1<-read.table("~/Dropbox/Courses/EVE100_2011/Grades/Exam1Grades.csv",as.is=T,sep=",")
midterm1[1,]
midterm1<-read.table("~/Dropbox/Courses/EVE100_2011/Grades/Exam1Grades.csv",as.is=T,sep=",",head=T)
midterm1[1,]
mean(midterm1$Score)
mean(midterm1$Score,na.rm=T)
quantile(midterm1$Score,na.rm=T,p=c(0.25,0.5,0.75,.9))
hist(midterm1$Score)
hist(midterm1$Score,breaks=20)
hist(midterm1$Score,breaks=20,xlab="Score")
abline(v=75,col="red",lwd=4)
hist(midterm1$Score,breaks=20,xlab="Score",main="MIDTERM 1 EVE100 W2011")
abline(v=75,col="red",lwd=4)
quantile(midterm1$Score,na.rm=T,p=c(0.1,0.25,0.5,0.75,.9))
dev.copy2pdf(file="~/Dropbox/Courses/EVE100_2011/Grades/Midterm1_eve100_w2011_hist.pdf")
traj<-function(p,w11,w12,w22,tgen=200){#w11<-.1#w12<-1#w22<-.1p.array<-pfor(i in 1:tgen){wbar<- w11*p^2 +w12*2*p*(1-p) + w22 * (1-p)^2margin<-p*(w11 - w12) + (1-p)*(w12 - w22)d_p<-p*(1-p)*(margin) /(wbar)p<- p+d_pp.array<-c(p.array,p)}#
plot(p.array,xlab="generations",ylab="Frequency of A1",type="l",lwd=3,col="red")#return(p.array)	}
traj(p=0.01,.90,0.95,1)
traj<-function(p,w11,w12,w22,tgen=200,add=FALSE){#w11<-.1#w12<-1#w22<-.1p.array<-pfor(i in 1:tgen){wbar<- w11*p^2 +w12*2*p*(1-p) + w22 * (1-p)^2margin<-p*(w11 - w12) + (1-p)*(w12 - w22)d_p<-p*(1-p)*(margin) /(wbar)p<- p+d_pp.array<-c(p.array,p)}#
plot(p.array,xlab="generations",ylab="Frequency of A1",type="l",lwd=3,col="red",add=add)#return(p.array)	}
traj(p=0.01,.80,0.95,1,add=TRUE)
traj<-function(p,w11,w12,w22,tgen=200,plot.it=TRUE){#w11<-.1#w12<-1#w22<-.1p.array<-pfor(i in 1:tgen){wbar<- w11*p^2 +w12*2*p*(1-p) + w22 * (1-p)^2margin<-p*(w11 - w12) + (1-p)*(w12 - w22)d_p<-p*(1-p)*(margin) /(wbar)p<- p+d_pp.array<-c(p.array,p)}#
if(plot.it==TRUE) plot(p.array,xlab="generations",ylab="Frequency of A1",type="l",lwd=3,col="red",add=add)if(plot.it=FALSE) return(p.array)	}
traj<-function(p,w11,w12,w22,tgen=200,plot.it=TRUE){#w11<-.1#w12<-1#w22<-.1p.array<-pfor(i in 1:tgen){wbar<- w11*p^2 +w12*2*p*(1-p) + w22 * (1-p)^2margin<-p*(w11 - w12) + (1-p)*(w12 - w22)d_p<-p*(1-p)*(margin) /(wbar)p<- p+d_pp.array<-c(p.array,p)}#
if(plot.it==TRUE) plot(p.array,xlab="generations",ylab="Frequency of A1",type="l",lwd=3,col="red",add=add)if(plot.it==FALSE) return(p.array)	}
traj<-traj(p=0.01,.80,0.95,1,plot.it=FALSE)
traj.2<-traj(p=0.01,.90,0.95,1,plot.it=FALSE)
traj.1<-traj(p=0.01,.80,0.95,1,plot.it=FALSE)
traj<-function(p,w11,w12,w22,tgen=200,plot.it=TRUE){#w11<-.1#w12<-1#w22<-.1p.array<-pfor(i in 1:tgen){wbar<- w11*p^2 +w12*2*p*(1-p) + w22 * (1-p)^2margin<-p*(w11 - w12) + (1-p)*(w12 - w22)d_p<-p*(1-p)*(margin) /(wbar)p<- p+d_pp.array<-c(p.array,p)}#
if(plot.it==TRUE) plot(p.array,xlab="generations",ylab="Frequency of A1",type="l",lwd=3,col="red",add=add)if(plot.it==FALSE) return(p.array)	}
traj.1<-traj(p=0.01,.80,0.95,1,plot.it=FALSE)
traj.2<-traj(p=0.01,.90,0.95,1,plot.it=FALSE)
plot(traj.1)
plot(traj.1,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="red")
lines(traj.2,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="red")
lines(traj.2,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="green")
traj.2<-traj(p=0.01,0.9,1,plot.it=FALSE)
traj.2<-traj(p=0.01,0.9,0.9,1,plot.it=FALSE)
lines(traj.2,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="green")
plot(traj.1,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="red")
lines(traj.2,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="green")
traj.3<-traj(p=0.01,0.95,0.99,1,plot.it=FALSE)
plot(traj.3,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="red")
plot(traj.1,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="red")
lines(traj.2,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="green")
lines(traj.3,xlab="generations",ylab="Frequency of A2",type="l",lwd=3,col="blue")
dev.copy2pdf(file="~/Dropbox/Courses/EVE100_2011/R_code_figures/deleterious_muts.pdf")
30/5
genetic.drift<-function(p,N,tgen,num.sims){#
p.initial = p#
 plot(x=c(0,tgen),c(0,1),type="",xlab="Generation",ylab="frequency")#
 #
 p<-p.initial#
 	p.array<-p#
 #
	for(j in 1:tgen){#
		i<-rbinom(1,size=2*N,prob=p)#
		#
		p<-i/(2*N)#
		p.array<-c(p.array,p)#
		}#
		lines(p.array)#
	}
genetic.drift(p=0.5,N=100,tgen=100,num.sims=1)
genetic.drift<-function(p,N,tgen,num.sims){#
p.initial = p#
 plot(x=c(0,tgen),c(0,1),type="n",xlab="Generation",ylab="frequency")#
 #
 p<-p.initial#
 	p.array<-p#
 #
	for(j in 1:tgen){#
		i<-rbinom(1,size=2*N,prob=p)#
		#
		p<-i/(2*N)#
		p.array<-c(p.array,p)#
		}#
		lines(p.array)#
	}
genetic.drift(p=0.5,N=100,tgen=100,num.sims=1)
genetic.drift(p=0.5,N=10,tgen=100,num.sims=1)
genetic.drift<-function(p,N,tgen,num.sims){#
p.initial = p#
 plot(x=c(0,tgen),c(0,1),type="n",xlab="Generation",ylab="frequency")#
 for(sim in 1:num.sims){#
 p<-p.initial#
 	p.array<-p#
 #
	for(j in 1:tgen){#
		i<-rbinom(1,size=2*N,prob=p)#
		#
		p<-i/(2*N)#
		p.array<-c(p.array,p)#
		}#
		lines(p.array,col=sim)#
		}#
	}
genetic.drift(p=0.5,N=10,tgen=100,num.sims=10)
genetic.drift(p=0.5,N=100,tgen=100,num.sims=10)
genetic.drift(p=0.1,N=100,tgen=100,num.sims=10)
2e-8
2e-8/1e6
2e-8*1e6
27/475
27/(475+27)
27/((475+27)/2)
0.107*6.5e6
27/((475)/2)
0.113*6.5e6
6.5 * 27/(475/2)
6.5 * 27/(475/2)*10^6
6.5 * 27/((27+475)/2)*10^6
7+8+8
.42*6.1
.42*6.1-.9
.25*56+.25+93+.15*100+93*.35
(.25*56)+(.25+93)+(.15*100)+(93*.35)
(.25*56)+(.25*93)+(.15*100)+(93*.35)
(.25*56)+(.25*93)+(.15*95)+(93*.35)
(.25*58)+(.25*93)+(.15*95)+(93*.35)
choose(5,2)
qbinom
qbinom(1,8,pron=0.5)
qbinom(1,8,prob=0.5)
dbinom(1,8,prob=0.5)
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/MT1_MT2.txt")
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/MT1_MT2.txt",as.is=TRUE)
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/MT1_MT2.txt",as.is=TRUE,sep="\t")
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/EVE_100_A01_A08_WQ_2011.csv",as.is=TRUE,sep="\t")
midterm[1,]
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/EVE_100_A01_A08_WQ_2011.csv",as.is=TRUE,sep="\t",head=T)
midterm[1,]
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/EVE_100_A01_A08_WQ_2011.csv",as.is=TRUE,sep=",",head=T)
midterm[1,]
midterm[1:10,]
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/EVE_100_A01_A08_WQ_2011_MT2.xls",as.is=TRUE,sep=",",head=T)
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/MT1_MT2.txt",as.is=TRUE,sep="\t")
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/MT1_MT2.txt",as.is=TRUE,sep="\t",fill=T)
midterm[1,]
midterm<-read.table("~/Dropbox/Courses/Eve100_2011/Grades/MT1_MT2.txt",as.is=TRUE,sep="\t",fill=T,head=T)
midterm[1,]
mean(midterm$Midterm.2)
mean(midterm$Midterm.2,na.rm=T)
mean(midterm$Midterm.2>90,na.rm=T)
quantile(midterm$Midterm.2,p=.8,na.rm=T)
quantile(midterm$Midterm.2,p=.75,na.rm=T)
quantile(midterm$Midterm.2,p=.7,na.rm=T)
quantile(midterm$Midterm.2,p=.75,na.rm=T)
help.search("sign test")
.25*50+.25*56+.15*90
.35*60
.35*100
.35*50
setwd("~/Dropbox/partial_sweeps/")
source("selection-dir/")
setwd("selection-dir/")
source("Rscripts/partial_draft.R")
source("Rscripts/partial_draft.R")
ls()
source("Rscripts/partial_draft.R")
source("Rscripts/partial_draft.R")
my.I.ki<-Generate.I.ki(10)
my.I.ki<-Generate.I.ki(10,x=0.2)
source("Rscripts/partial_draft.R")
my.I.ki<-Generate.I.ki(10,x=0.2)
my.I.ki
source("Rscripts/partial_draft.R")
plot(x=c(0,1),y=c(0.0,0.7),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=0.9*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,x=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(q=q,n=10,rho=rho))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1])#
#
#
text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)
}
getwd()
setwd("msseldir/")
tsel=2*log(10000)/param$s#
q=0.9*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,x=q)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(q=q,n=10,rho=rho))}#
lines(1/(1+rhos*q^2),times[,2]/times[,1])
plot(x=c(0,1),y=c(0.0,0.7),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=0.9*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,x=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(q=q,n=10,rho=rho))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1])#
#
#
text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)
}
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=0.9*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(q=q,n=10,rho=rho))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1])#
#
#
text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
}#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)
#
#
#
#
#
tot.time<-function(n,rho,my.I.ki){#
trans.mat<-numeric()#
tot.rate=numeric(n)#
for(k in n:2){#
rates<- rho * my.I.ki[[k]]#
rates[1] <- rates[1] + choose(k,2)#
#
tot.rate[n-k+1] = sum(rates)#
prob<-rates/sum(rates)#
trans.mat<-rbind(trans.mat,c(rep(0,n-k+1),prob))#
#
 #
}#
trans.mat<-rbind(trans.mat,rep(0,n))#
#
#
Gnk<-rep(0,n)#
Gnk[1] = 1#
Snk<-rep(0,n)#
Snk[1] = 1#
#
j=n:1#
for(k in (n-1):2){#
	Gnk[n-k+1] = sum(Gnk * trans.mat[,n-k+1])#
#
	i <- j-k+1 #how many lineages coaled#
#
prob.single<- 1-i/j#
#
	Snk[n-k+1] = sum(Snk * trans.mat[,n-k+1]*prob.single)#
	}#
#
return(c(sum(n:2*Gnk[-n]/tot.rate[-n]),sum(n*Snk[-n]/tot.rate[-n])))#
	#
	}
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=0.9*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(q=q,n=10,rho=rho))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1])#
#
#
text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
}#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)
 plot(x=c(0,1),y=c(0.0,0.7),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=0.9*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1])#
#
#
text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
}#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)
 plot(x=c(0,1),y=c(0.0,0.7),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
col=col+1;#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=0.9*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
}
 plot(x=c(0,1),y=c(0.0,0.7),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
load(file="freq.spec.decreasing.pi.Robj")#
plot(x=-log10(c(1,1e-3)),y=c(0.2,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=inf.sweep.freq[i,1]/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=1/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),sweep.freq[,1]/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))#
dev.copy2eps(file="../figures/Singletons_reduction_pi.eps")#
#
plot(x=-log10(c(1,1e-3)),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))#
#
#
plot(x=-log10(c(1,1e-3))),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(18:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))#
#
#
#
num.high.freq<-sapply(1:length(x),function(i){return(sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]))})#
plot(x,num.high.freq)#
abline(h=sum(1/c(18:19))/sum(1/(18:19)),col="lightgrey")
load(file="../figures/freq.spec.decreasing.pi.Robj")#
plot(x=-log10(c(1,1e-3)),y=c(0.2,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=inf.sweep.freq[i,1]/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=1/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),sweep.freq[,1]/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))#
dev.copy2eps(file="../figures/Singletons_reduction_pi.eps")#
#
plot(x=-log10(c(1,1e-3)),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=-log10(c(1,1e-3))),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(18:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=-log10(c(1,1e-3))),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(18:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=-log10(c(1,1e-3)),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=-log10(c(1,1e-3)),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
load(file="../figures/freq.spec.decreasing.pi.Robj")#
plot(x=-log10(c(1,1e-3)),y=c(0.2,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=inf.sweep.freq[i,1]/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=1/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),sweep.freq[,1]/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
for(index in 1:length(x)){#
	#
#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(10,x=x[index])#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=index,lty=2)#
	}
load(file="../figures/freq.spec.decreasing.pi.Robj")#
plot(x=-log10(c(1,1e-3)),y=c(0.2,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=inf.sweep.freq[i,1]/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=1/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),sweep.freq[,1]/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))#
#
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(10,x=x[index])#
pi<-1/(1+rhos*my.I.ki)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(-log10(),times[,2]/times[,1],col=index,lty=2)#
	}
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(10,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(-log10(),times[,2]/times[,1],col=index,lty=2)#
	}
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(10,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(-log10(pi),times[,2]/times[,1],col=index,lty=2)#
	}
load(file="../figures/freq.spec.decreasing.pi.Robj")#
plot(x=-log10(c(1,1e-3)),y=c(0.2,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=inf.sweep.freq[i,1]/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=1/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),sweep.freq[,1]/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
#
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(-log10(),times[,2]/times[,1],col=index,lty=2)#
	}
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(-log10(pi),times[,2]/times[,1],col=index,lty=2)#
	}
1/(1/(1:20))
1/sum(1/(1:20))
points(1,0.28)
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(-log10(pi),times[,2]/times[,1],col=index,lty=2)#
	}
load(file="../figures/freq.spec.decreasing.pi.Robj")#
plot(x=-log10(c(1,1e-3)),y=c(0.2,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=inf.sweep.freq[i,1]/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=1/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),sweep.freq[,1]/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(-log10(pi),times[,2]/times[,1],col=index,lty=2)#
	}
load(file="../figures/freq.spec.decreasing.pi.Robj")#
plot(x=-log10(c(1,1e-3)),y=c(0.2,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=inf.sweep.freq[i,1]/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=1/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
points(-log10(c(pi,new.pi)),sweep.freq[,1]/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(-log10(pi),times[,2]/times[,1],col=index,lty=2)#
	}
plot(x=c(0,1),y=c(0,1),type="n"); for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2)#
	}
plot(x=c(0,1),y=c(0,1),type="n"); for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2)#
	}
lot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n"); #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,20000,by=4))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2) ##use log10 pi #
	}
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n"); #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,20000,by=4))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2) ##use log10 pi #
	}
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)"; #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2) ##use log10 pi #
limit<-tot.time(n=20,rho=1,my.I.ki,switch.drift=0)#
points(0,limit[2]/limit[1],col=index,pch=19)#
	}
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)"); #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2) ##use log10 pi #
limit<-tot.time(n=20,rho=1,my.I.ki,switch.drift=0)#
points(0,limit[2]/limit[1],col=index,pch=19)#
	}
#
#
source("partial_draft.R")#
#
#
tot.time<-function(n,rho,my.I.ki,switch.drift=1){#
trans.mat<-numeric()#
tot.rate=numeric(n)#
for(k in n:2){#
rates<- rho * my.I.ki[[k]]#
rates[1] <- rates[1] + switch.drift*choose(k,2)#
#
tot.rate[n-k+1] = sum(rates)#
prob<-rates/sum(rates)#
trans.mat<-rbind(trans.mat,c(rep(0,n-k+1),prob))#
#
 #
}#
trans.mat<-rbind(trans.mat,rep(0,n))#
#
#
Gnk<-rep(0,n)#
Gnk[1] = 1#
Snk<-rep(0,n)#
Snk[1] = 1#
#
j=n:1#
for(k in (n-1):2){#
	Gnk[n-k+1] = sum(Gnk * trans.mat[,n-k+1])#
#
	i <- j-k+1 #how many lineages coaled#
#
prob.single<- 1-i/j#
#
	Snk[n-k+1] = sum(Snk * trans.mat[,n-k+1]*prob.single)#
	}#
#
return(c(sum(n:2*Gnk[-n]/tot.rate[-n]),sum(n*Snk[-n]/tot.rate[-n])))#
	#
	}
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)"); #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2) ##use log10 pi #
limit<-tot.time(n=10,rho=1,my.I.ki,switch.drift=0)#
points(0,limit[2]/limit[1],col=index,pch=19)#
	}
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)"); #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(pi,times[,2]/times[,1],col=index,lty=2) ##use log10 pi #
	}
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)"; #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
limit<-tot.time(n=20,rho=1,my.I.ki,switch.drift=0)#
limit.case<-limit[2]/limit[1]#
lines(c(pi,0),c(times[,2]/times[,1],limit.case),col=index,lty=2) ##use log10 pi #
points(0,limit.case,col=index,pch=19)#
	}
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)
load(file="../figures/freq.spec.decreasing.pi.Robj"); for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),rowSums(sweep.freq[,19])/rowSums(sweep.freq),col=index)#
}
load(file="../figures/freq.spec.decreasing.pi.Robj"); for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),sweep.freq[,19]/rowSums(sweep.freq),col=index)#
}
load(file="../figures/freq.spec.decreasing.pi.Robj"); for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),sweep.freq[,10]/rowSums(sweep.freq),col=index)#
}
param
2000/600
600/2000
1/10/(sum(1/1:10))
 plot(x=c(0,1),y=c(0.0,0.7),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,2,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.9,1.5),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep)/neutral[these],col=col,pch=20)#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i])/neutal[these],col=col,pch=19)#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1]/neutral[these],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.9,1.5),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep)/neutral[9],col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i])//neutal[these],col=col,pch=19) #/neutal[these]#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1]/neutral[1],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.9,1.5),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep)/neutral[9],col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i])/neutal[these],col=col,pch=19) #/neutal[these]#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1]/neutral[1],col=col)#
col=col+1;
}
 plot(x=c(0,1),y=c(0.9,1.5),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep)/neutral[9],col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i])/neutral[these],col=col,pch=19) #/neutal[these]#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1]/neutral[1],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.9,1.5),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19) #/neutal[these]#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.0,1),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,pch=20)#
#
 for(i in 1:length(rhos)){#
 	points(rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),length(these)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=19) #/neutal[these]#
# 	points(rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),length(these)), p.sweep[these,i]/sum(p.sweep[1:n,i]),col=col,pch=20)#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
?points
 plot(x=c(0,1),y=c(0.0,1),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,23)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these,i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.0,1),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,23)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these[j],i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.0,1),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,23)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these[j],i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types[j]) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
 plot(x=c(0,1),y=c(0.0,1),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,22)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these[j],i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types[j]) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}#
#
text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)#
 #
dev.copy2eps(file="../figures/const_q_pi_vs_freq_spec.eps")#
#
}
 plot(x=c(0,1),y=c(0.0,1),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,22)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these[j],i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types[j],bg=index) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}#
#
#text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)#
 #
dev.copy2eps(file="../figures/const_q_pi_vs_freq_spec.eps")
plot(x=c(0,1),y=c(0.0,1),type="n",xlab=expression(pi),ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,22)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these[j],i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types[j],bg=col) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}#
#
#text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)#
 #
dev.copy2eps(file="../figures/const_q_pi_vs_freq_spec.eps")
 plot(x=c(0,1),y=c(0.0,1),type="n",xlab="Reduction in diversity (pi_S/pi_0)",ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,22)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these[j],i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types[j],bg=col) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}#
#
#text(label="i=2",x=0.4,y=0.22)#
text(label="i=n-1",x=0.4,y=0.08) #
text(label="i=1",x=0.4,y=0.55)#
#
 legend(x=0.6,y=0.7,legend=c("x=0.9","x=0.5","x=0.2"),col=1:3,pch=20)#
 #
dev.copy2eps(file="../figures/const_q_pi_vs_freq_spec.eps")
x
plot(x=-log10(c(1,1e-3)),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
load(file="../figures/freq.spec.decreasing.pi.Robj")
plot(x=-log10(c(1,1e-3)),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(-log10(c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=c(0,1),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=c(0,1),y=c(0.0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=c(0,1),y=c(0.0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))0
plot(x=c(0,1),y=c(0.0,0.1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=c(0,1),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines((c(pi,new.pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=c(0,1),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
#sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
points((c(pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=c(0,1),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
#sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
points((c(pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
plot(x=c(0,1),y=c(0.0,0.06),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)",xaxt="n")#
#sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
#sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
points((c(pi)),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
 plot(x=c(0,1),y=c(0.0,0.1),type="n",xlab="Reduction in diversity (pi_S/pi_0)",ylab="Fraction of segregating sites at freq. i/n");#
#
files= dir("../results/freq_spec_ms_vs_p/")#
col=1#
these<-c(1,9)#
point.types= c(19,22)#
for(file in files[1:3]){#
  n=10#
load(paste("../results/freq_spec_ms_vs_p/",file,sep=""))#
 neutral<-1/(1:(n))/sum(1/(1:(n)))#
print(param$p0)#
#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
#
 #	 	lines(1/(1+rhos*q^2),p.sweep[2,]/colSums(p.sweep),col=col,pch=20)  #/neutral[these]#
lines(1/(1+rhos*q^2),p.sweep[9,]/colSums(p.sweep),col=col,lty=2)#
#
 for(i in 1:length(rhos)){#
 	for(j in 1:length(these)){#
 	points(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)), ms.sweep[these[j],i]/sum(ms.sweep[1:n,i]),col=col,pch=point.types[j],bg=col) #
 	}#
 	 #
 	rho_star = 1/((1/rhos[i]) + param$tdelay+2*tsel)#
 	 	cat(rhos[i], " ",rho_star," ", rep(sum(p.sweep[,i]*(1:n/n)*(1-1:n/n)/(10000)),1)," ")#
 #
 	cat(1/(1+rhos[i]*q^2))#
 	cat(" ",rep(2*sum(ms.sweep[,i]*(1:n/n)*(1-1:n/n)/(100)),1), " ",1/(1+rho_star*q^2),"\n")#
#
#
 	 	}#
#
rhos.seq<-seq(0,10000,by=2)#
tsel=2*log(10000)/param$s#
q=param$p0*exp(-param$recom*tsel)#
rhos<-seq(1,10000,by=2)#
my.I.ki<-Generate.I.ki.const(10,q=q)#
times<-numeric();for(rho in rhos.seq){times<-rbind(times,tot.time(n=10,rho=rho,my.I.ki))}#
lines(1/(1+rhos.seq*q^2),times[,2]/times[,1],col=col)#
col=col+1;#
}
#
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)"; #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
limit<-tot.time(n=20,rho=1,my.I.ki,switch.drift=0)#
limit.case<-limit[2]/limit[1]#
lines(c(pi,0),c(times[,2]/times[,1],limit.case),col=index) ##use log10 pi #
points(0,limit.case,col=index,pch=19)#
	}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)
#
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)") #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
limit<-tot.time(n=20,rho=1,my.I.ki,switch.drift=0)#
limit.case<-limit[2]/limit[1]#
lines(c(pi,0),c(times[,2]/times[,1],limit.case),col=index) ##use log10 pi #
points(0,limit.case,col=index,pch=19)#
	}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)
x=c(1,0.5,0.2,.05)
#
plot(x=c(0,1),y=c(0,1),type="n",ylab="Fraction of singleton sites",xlab="Reduction in diversity (pi_S/pi_0)") #
for(index in 1:length(x)){#
#
#
 I_22<-integrate(I_ki, lower=0, upper=10,k=2,i=2,x=x[index])[[1]]#
#
swp.rates.2<-(1/pi -1)/I_22#
	#
rhos<-c(seq(0,1,length=5),seq(1,10000,by=2))#
my.I.ki<-Generate.I.ki(20,x=x[index])#
pi<-1/(1+rhos*I_22)#
times<-numeric();for(rho in rhos){times<-rbind(times,tot.time(n=20,rho=rho,my.I.ki))}#
limit<-tot.time(n=20,rho=1,my.I.ki,switch.drift=0)#
limit.case<-limit[2]/limit[1]#
lines(c(pi,0),c(times[,2]/times[,1],limit.case),col=index) ##use log10 pi #
points(0,limit.case,col=index,pch=19)#
	}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)
sapply(1:length(x),function(i){abline(h=sum(inf.sweep.freq[i,18:19])/sum(inf.sweep.freq[i,]),col=i,lty=3)})#
abline(h=sum(1/c(18:19))/sum(1/(1:19)),col="lightgrey")#
for(index in 1:length(x)){#
sweep.freq<-sweep.freqs[[index]]#
sweep.freq<-rbind(sweep.freq,new.sweep.freqs[[index]])#
sweep.rates<-seq(0,500,length=20)#
lines(c(pi,new.pi),rowSums(sweep.freq[,18:19])/rowSums(sweep.freq),col=index)#
}#
legend(x=0.8,y=1.05,col=1:5,legend=paste("x=",format(x,2)),pch=19)#
axis(side=1,at=-log10(c(1,.5,0.2,0.1,.05,0.01,0.005,.001)),lab=c("1","0.5","0.2","0.1","0.05","0.01","0.005","0.001"))
100*0.3^2
50*0.3^2
